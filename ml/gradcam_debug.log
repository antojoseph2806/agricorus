2026-02-17 12:16:10,444 - INFO - Starting Grad-CAM generation for Tomato___Late_blight
2026-02-17 12:16:10,446 - INFO - Using layer: Conv_1
2026-02-17 12:16:10,448 - ERROR - ERROR generating Grad-CAM: The layer sequential has never been called and thus has no defined input.
2026-02-17 12:16:10,450 - ERROR - Traceback: Traceback (most recent call last):
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\app.py", line 239, in predict
    heatmap = generate_gradcam(model, img_array, predicted_index)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\app.py", line 113, in generate_gradcam
    inputs=model.input,
           ^^^^^^^^^^^
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\venv\Lib\site-packages\keras\src\ops\operation.py", line 337, in input
    return self._get_node_attribute_at_index(0, "input_tensors", "input")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\venv\Lib\site-packages\keras\src\ops\operation.py", line 368, in _get_node_attribute_at_index
    raise AttributeError(
AttributeError: The layer sequential has never been called and thus has no defined input.

2026-02-17 12:17:03,622 - INFO - Model weights loaded successfully from .h5 file!
2026-02-17 12:17:08,173 - INFO - Model weights loaded successfully from .h5 file!
2026-02-17 12:17:37,934 - INFO - Starting Grad-CAM generation for Tomato___Late_blight
2026-02-17 12:17:37,934 - INFO - Using layer: Conv_1
2026-02-17 12:17:37,934 - ERROR - ERROR generating Grad-CAM: The layer sequential has never been called and thus has no defined output.
2026-02-17 12:17:37,938 - ERROR - Traceback: Traceback (most recent call last):
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\app.py", line 240, in predict
    heatmap = generate_gradcam(model, img_array, predicted_index)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\app.py", line 115, in generate_gradcam
    outputs=[last_conv_layer.output, model.output]
                                     ^^^^^^^^^^^^
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\venv\Lib\site-packages\keras\src\ops\operation.py", line 349, in output
    return self._get_node_attribute_at_index(0, "output_tensors", "output")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\venv\Lib\site-packages\keras\src\ops\operation.py", line 368, in _get_node_attribute_at_index
    raise AttributeError(
AttributeError: The layer sequential has never been called and thus has no defined output.

2026-02-17 12:18:13,903 - INFO - Starting Grad-CAM generation for Tomato___Late_blight
2026-02-17 12:18:13,905 - INFO - Using layer: Conv_1
2026-02-17 12:18:13,907 - ERROR - ERROR generating Grad-CAM: The layer sequential has never been called and thus has no defined output.
2026-02-17 12:18:13,909 - ERROR - Traceback: Traceback (most recent call last):
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\app.py", line 240, in predict
    heatmap = generate_gradcam(model, img_array, predicted_index)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\app.py", line 115, in generate_gradcam
    outputs=[last_conv_layer.output, model.output]
                                     ^^^^^^^^^^^^
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\venv\Lib\site-packages\keras\src\ops\operation.py", line 349, in output
    return self._get_node_attribute_at_index(0, "output_tensors", "output")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\venv\Lib\site-packages\keras\src\ops\operation.py", line 368, in _get_node_attribute_at_index
    raise AttributeError(
AttributeError: The layer sequential has never been called and thus has no defined output.

2026-02-17 12:20:14,396 - INFO - Model weights loaded successfully from .h5 file!
2026-02-17 12:21:38,560 - INFO - Starting Grad-CAM generation for Tomato___Late_blight
2026-02-17 12:21:38,560 - INFO - Using layer: Conv_1
2026-02-17 12:21:38,560 - ERROR - ERROR generating Grad-CAM: The layer sequential has never been called and thus has no defined output.
2026-02-17 12:21:38,566 - ERROR - Traceback: Traceback (most recent call last):
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\app.py", line 240, in predict
    heatmap = generate_gradcam(model, img_array, predicted_index)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\app.py", line 115, in generate_gradcam
    outputs=[last_conv_layer.output, model.output]
                                     ^^^^^^^^^^^^
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\venv\Lib\site-packages\keras\src\ops\operation.py", line 349, in output
    return self._get_node_attribute_at_index(0, "output_tensors", "output")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\venv\Lib\site-packages\keras\src\ops\operation.py", line 368, in _get_node_attribute_at_index
    raise AttributeError(
AttributeError: The layer sequential has never been called and thus has no defined output.

2026-02-17 12:22:54,187 - INFO - Model weights loaded successfully from .h5 file!
2026-02-17 12:23:21,318 - INFO - Starting Grad-CAM generation for Tomato___Late_blight
2026-02-17 12:23:21,320 - INFO - Using layer: Conv_1
2026-02-17 12:23:21,320 - ERROR - ERROR generating Grad-CAM: The layer sequential has never been called and thus has no defined output.
2026-02-17 12:23:21,322 - ERROR - Traceback: Traceback (most recent call last):
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\app.py", line 240, in predict
    heatmap = generate_gradcam(model, img_array, predicted_index)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\app.py", line 115, in generate_gradcam
    outputs=[last_conv_layer.output, model.output]
                                     ^^^^^^^^^^^^
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\venv\Lib\site-packages\keras\src\ops\operation.py", line 349, in output
    return self._get_node_attribute_at_index(0, "output_tensors", "output")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\venv\Lib\site-packages\keras\src\ops\operation.py", line 368, in _get_node_attribute_at_index
    raise AttributeError(
AttributeError: The layer sequential has never been called and thus has no defined output.

2026-02-17 12:24:29,136 - INFO - Starting Grad-CAM generation for Peach___Bacterial_spot
2026-02-17 12:24:29,136 - INFO - Using layer: Conv_1
2026-02-17 12:24:29,139 - ERROR - ERROR generating Grad-CAM: The layer sequential has never been called and thus has no defined output.
2026-02-17 12:24:29,143 - ERROR - Traceback: Traceback (most recent call last):
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\app.py", line 240, in predict
    # Generate Grad-CAM heatmap
                  ^^^^^^^^^^^^^^
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\app.py", line 115, in generate_gradcam
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\venv\Lib\site-packages\keras\src\ops\operation.py", line 349, in output
    return self._get_node_attribute_at_index(0, "output_tensors", "output")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\venv\Lib\site-packages\keras\src\ops\operation.py", line 368, in _get_node_attribute_at_index
    raise AttributeError(
AttributeError: The layer sequential has never been called and thus has no defined output.

2026-02-17 12:24:47,121 - INFO - Model weights loaded successfully from .h5 file!
2026-02-17 12:25:36,623 - INFO - Starting Grad-CAM generation for Tomato___Late_blight
2026-02-17 12:25:36,625 - INFO - Using layer: Conv_1
2026-02-17 12:25:36,625 - ERROR - ERROR generating Grad-CAM: The layer sequential has never been called and thus has no defined output.
2026-02-17 12:25:36,629 - ERROR - Traceback: Traceback (most recent call last):
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\app.py", line 240, in predict
    # Generate Grad-CAM heatmap
                  ^^^^^^^^^^^^^^
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\app.py", line 115, in generate_gradcam
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\venv\Lib\site-packages\keras\src\ops\operation.py", line 349, in output
    return self._get_node_attribute_at_index(0, "output_tensors", "output")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\venv\Lib\site-packages\keras\src\ops\operation.py", line 368, in _get_node_attribute_at_index
    raise AttributeError(
AttributeError: The layer sequential has never been called and thus has no defined output.

2026-02-17 12:26:55,799 - INFO - Model weights loaded successfully from .h5 file!
2026-02-17 12:27:10,421 - INFO - Starting Grad-CAM generation for Tomato___Late_blight
2026-02-17 12:27:10,421 - INFO - Using layer: Conv_1
2026-02-17 12:27:10,421 - ERROR - ERROR generating Grad-CAM: The layer sequential has never been called and thus has no defined output.
2026-02-17 12:27:10,428 - ERROR - Traceback: Traceback (most recent call last):
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\app.py", line 240, in predict
    # Generate Grad-CAM heatmap
                  ^^^^^^^^^^^^^^
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\app.py", line 115, in generate_gradcam
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\venv\Lib\site-packages\keras\src\ops\operation.py", line 349, in output
    return self._get_node_attribute_at_index(0, "output_tensors", "output")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\venv\Lib\site-packages\keras\src\ops\operation.py", line 368, in _get_node_attribute_at_index
    raise AttributeError(
AttributeError: The layer sequential has never been called and thus has no defined output.

2026-02-17 12:28:14,867 - INFO - Model weights loaded successfully from .h5 file!
2026-02-17 12:28:38,109 - INFO - Starting Grad-CAM generation for Tomato___Late_blight
2026-02-17 12:28:38,109 - INFO - Using layer: Conv_1
2026-02-17 12:28:38,112 - ERROR - ERROR generating Grad-CAM: The layer sequential has never been called and thus has no defined output.
2026-02-17 12:28:38,115 - ERROR - Traceback: Traceback (most recent call last):
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\app.py", line 240, in predict
    # Generate Grad-CAM heatmap
                  ^^^^^^^^^^^^^^
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\app.py", line 115, in generate_gradcam
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\venv\Lib\site-packages\keras\src\ops\operation.py", line 349, in output
    return self._get_node_attribute_at_index(0, "output_tensors", "output")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\venv\Lib\site-packages\keras\src\ops\operation.py", line 368, in _get_node_attribute_at_index
    raise AttributeError(
AttributeError: The layer sequential has never been called and thus has no defined output.

2026-02-17 12:29:56,074 - INFO - Model weights loaded successfully from .h5 file!
2026-02-17 12:30:30,170 - INFO - Starting Grad-CAM generation for Tomato___Late_blight
2026-02-17 12:30:30,170 - INFO - Using layer: Conv_1
2026-02-17 12:30:30,173 - ERROR - ERROR generating Grad-CAM: The layer sequential has never been called and thus has no defined output.
2026-02-17 12:30:30,175 - ERROR - Traceback: Traceback (most recent call last):
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\app.py", line 240, in predict
    confidence = float(np.max(predictions) * 100)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\app.py", line 115, in generate_gradcam
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\venv\Lib\site-packages\keras\src\ops\operation.py", line 349, in output
    return self._get_node_attribute_at_index(0, "output_tensors", "output")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\venv\Lib\site-packages\keras\src\ops\operation.py", line 368, in _get_node_attribute_at_index
    raise AttributeError(
AttributeError: The layer sequential has never been called and thus has no defined output.

2026-02-17 12:32:44,583 - INFO - Starting Grad-CAM generation for Tomato___Late_blight
2026-02-17 12:32:44,587 - INFO - Using layer: Conv_1
2026-02-17 12:32:44,594 - ERROR - ERROR generating Grad-CAM: The layer sequential has never been called and thus has no defined output.
2026-02-17 12:32:44,598 - ERROR - Traceback: Traceback (most recent call last):
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\app.py", line 240, in predict
    "plant": label.split("___")[0],
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\app.py", line 115, in generate_gradcam
    grads = tape.gradient(loss, conv_outputs)
                                         ^^^^^
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\venv\Lib\site-packages\keras\src\ops\operation.py", line 349, in output
    return self._get_node_attribute_at_index(0, "output_tensors", "output")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\venv\Lib\site-packages\keras\src\ops\operation.py", line 368, in _get_node_attribute_at_index
    raise AttributeError(
AttributeError: The layer sequential has never been called and thus has no defined output.

2026-02-17 12:32:47,832 - INFO - Model weights loaded successfully from .h5 file!
2026-02-17 12:33:39,541 - INFO - Model built successfully
2026-02-17 12:33:39,855 - INFO - Model weights loaded successfully from .h5 file!
2026-02-17 12:33:54,491 - INFO - Starting Grad-CAM generation for Tomato___Late_blight
2026-02-17 12:33:54,491 - INFO - Using layer: Conv_1
2026-02-17 12:33:54,491 - ERROR - ERROR generating Grad-CAM: The layer sequential has never been called and thus has no defined output.
2026-02-17 12:33:54,501 - ERROR - Traceback: Traceback (most recent call last):
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\app.py", line 240, in predict
    logger.error(f"ERROR generating Grad-CAM: {e}")
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\app.py", line 115, in generate_gradcam
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\venv\Lib\site-packages\keras\src\ops\operation.py", line 349, in output
    return self._get_node_attribute_at_index(0, "output_tensors", "output")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\venv\Lib\site-packages\keras\src\ops\operation.py", line 368, in _get_node_attribute_at_index
    raise AttributeError(
AttributeError: The layer sequential has never been called and thus has no defined output.

2026-02-17 12:36:04,450 - INFO - Model built successfully
2026-02-17 12:36:04,767 - INFO - Model weights loaded successfully from .h5 file!
2026-02-17 12:36:26,547 - INFO - Starting Grad-CAM generation for Tomato___Late_blight
2026-02-17 12:36:26,547 - INFO - Using layer: Conv_1
2026-02-17 12:36:26,547 - ERROR - ERROR generating Grad-CAM: The layer sequential has never been called and thus has no defined output.
2026-02-17 12:36:26,556 - ERROR - Traceback: Traceback (most recent call last):
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\app.py", line 240, in predict
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\app.py", line 115, in generate_gradcam
    conv_layer_index = None
                            
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\venv\Lib\site-packages\keras\src\ops\operation.py", line 349, in output
    return self._get_node_attribute_at_index(0, "output_tensors", "output")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\venv\Lib\site-packages\keras\src\ops\operation.py", line 368, in _get_node_attribute_at_index
    raise AttributeError(
AttributeError: The layer sequential has never been called and thus has no defined output.

2026-02-17 12:37:50,441 - INFO - Model built successfully
2026-02-17 12:37:50,763 - INFO - Model weights loaded successfully from .h5 file!
2026-02-17 12:38:09,622 - INFO - Starting Grad-CAM generation for Tomato___Late_blight
2026-02-17 12:38:09,622 - INFO - Using layer: Conv_1
2026-02-17 12:38:09,627 - ERROR - ERROR generating Grad-CAM: The layer sequential has never been called and thus has no defined output.
2026-02-17 12:38:09,632 - ERROR - Traceback: Traceback (most recent call last):
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\app.py", line 240, in predict
    "plant": label.split("___")[0],
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\app.py", line 115, in generate_gradcam
    grads = tape.gradient(loss, conv_outputs)
                                         ^^^^^
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\venv\Lib\site-packages\keras\src\ops\operation.py", line 349, in output
    return self._get_node_attribute_at_index(0, "output_tensors", "output")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\antom\OneDrive\Documents\agricorus\ml\venv\Lib\site-packages\keras\src\ops\operation.py", line 368, in _get_node_attribute_at_index
    raise AttributeError(
AttributeError: The layer sequential has never been called and thus has no defined output.

2026-02-17 12:39:57,085 - INFO - Model built successfully
2026-02-17 12:39:58,030 - INFO - Model weights loaded successfully from .h5 file!
2026-02-17 12:40:25,044 - INFO - Starting Grad-CAM generation for Tomato___Late_blight
2026-02-17 12:40:25,044 - INFO - Using layer: Conv_1
2026-02-17 12:40:27,298 - INFO - Heatmap generated, creating overlay
2026-02-17 12:40:27,353 - INFO - SUCCESS: Grad-CAM generated for Tomato___Late_blight, length: 22136
